<ion-header [translucent]="true">
  <app-header-bar [loading]="loading" title="CARRITO"></app-header-bar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="content">
    <div class="complex-input">
      <ion-input [disabled]="true" labelPlacement="stacked" placeholder="Seleccione un cliente" fill="outline"
        label="CLIENTE" [value]="client?.name"></ion-input>
      <ion-button (click)="onSearchClients()">
        <ion-icon name="search"></ion-icon>
      </ion-button>
    </div>
    @if(this.client){
    <ion-select labelPlacement="stacked" fill="outline" [(ngModel)]="sellType" label="Tipo de venta">
      <ion-select-option value="spot">Contado</ion-select-option>
      <ion-select-option value="credit">Crédito</ion-select-option>
    </ion-select>
    }


    @for(product of this.products; track $index){
    <div class="cart" [ngClass]="{'product-disabled': !product.product.state}">
      <div class="icon">
        <img [src]="product.photo ? product.photo : '../../../assets/no-image.png'" alt="Not found" />
      </div>
      <div class="cart-content">
        <div class="cart-header">
          <ion-label>{{ product.product.name }}</ion-label>
          <ion-icon (click)="removeProduct(product)" color="danger" name="trash" slot="icon-only"></ion-icon>
        </div>
        <ion-label><b>{{ product.unit.name }} - ${{ product.price.price | number:'1.2-2'
            }}</b></ion-label>
        <div class="cart-footer">
          <span>Total: ${{ getTotalArticle(product) | number:'1.2-2' }}</span>
          <ion-input [disabled]="loading" label-placement="stacked" fill="outline" label="Cantidad" type="number"
            name="amount-{{product.product.id}}" [(ngModel)]="product.amount"></ion-input>
        </div>
      </div>
    </div>
    }@empty { @if(loading){
    <ion-label color="danger">CARGANDO...</ion-label>
    }@else {
    <ion-label>SIN ARTÍCULOS EN EL CARRITO</ion-label>
    } }
  </div>
</ion-content>
<ion-footer>
  <ion-toolbar color="primary">
    <ion-label slot="start" color="light">Total: ${{ getTotal() | number:'1.2-2' }}</ion-label>
    <ion-button (click)="onSave()" color="secondary" slot="end">Realizar Compra</ion-button>
  </ion-toolbar>
</ion-footer>